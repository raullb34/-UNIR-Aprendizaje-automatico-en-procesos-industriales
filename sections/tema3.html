<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tema 3: Preprocesamiento y Normalización</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .card { @apply bg-white p-6 rounded-xl shadow-md border border-gray-100 hover:shadow-lg transition-shadow; }
        .badge { @apply px-2 py-1 rounded text-xs font-bold uppercase; }
        .concept-title { @apply text-xl font-bold text-indigo-700 mb-2 flex items-center gap-2; }
        pre { @apply bg-gray-800 text-gray-100 p-4 rounded-lg overflow-x-auto text-sm my-3; }
        .math-block { @apply bg-gray-50 p-4 rounded-lg text-center my-4 border border-indigo-50 shadow-inner; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans leading-relaxed">

    <!-- Header -->
    <header class="bg-indigo-600 text-white py-12 px-6 shadow-lg">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-4xl font-extrabold mb-2">Tema 3: Calidad y Preprocesamiento</h1>
            <p class="text-indigo-100 text-lg">Dominando la limpieza, imputación y normalización de datos industriales.</p>
        </div>
    </header>

    <main class="max-w-5xl mx-auto p-6 space-y-12">
        
        <!-- Sección 1: Ecuaciones de Normalización -->
        <section>
            <h2 class="text-2xl font-bold text-gray-700 mb-6 border-b-2 border-indigo-200 pb-2">1. Normalización y Escalamiento (Cap. 3.6 y 3.7)</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="card border-t-4 border-indigo-500">
                    <h3 class="font-bold text-lg mb-2">Normalización Mín-Máx</h3>
                    <p class="text-sm text-gray-600 mb-4">Transforma los datos a un rango específico (normalmente [0, 1]). Útil cuando no conocemos la distribución.</p>
                    <div class="math-block text-xl">
                        $$x' = \frac{x - \min(x)}{\max(x) - \min(x)}$$
                    </div>
                </div>
                <div class="card border-t-4 border-blue-500">
                    <h3 class="font-bold text-lg mb-2">Estandarización (Z-Score)</h3>
                    <p class="text-sm text-gray-600 mb-4">Transforma los datos para que tengan media 0 y desviación típica 1. Ideal para algoritmos sensibles a la escala.</p>
                    <div class="math-block text-xl">
                        $$z = \frac{x - \mu}{\sigma}$$
                    </div>
                </div>
            </div>
        </section>

        <!-- Sección 2: Simulador de Imputación -->
        <section class="bg-white p-8 rounded-2xl shadow-md border border-indigo-100">
            <h2 class="text-2xl font-bold text-gray-700 mb-2">2. Simulador: El Impacto de la Imputación (Cap. 3.4)</h2>
            <p class="text-gray-500 mb-6 italic text-sm">Añade un valor atípico extremo (Outlier) con el slider y observa cómo la Media se desplaza más que la Mediana afectando al relleno de datos ausentes.</p>
            
            <div class="grid md:grid-cols-3 gap-8 items-center">
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">Valor del Dato Atípico:</label>
                        <input type="range" id="outlierSlider" min="10" max="200" value="50" class="w-full h-2 bg-indigo-200 rounded-lg appearance-none cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-400 mt-1">
                            <span>Bajo (10)</span>
                            <span id="sliderVal" class="font-bold text-indigo-600">50</span>
                            <span>Extremo (200)</span>
                        </div>
                    </div>
                    
                    <div class="p-4 bg-indigo-50 rounded-lg text-sm space-y-2">
                        <p><strong>Media:</strong> <span id="meanText" class="text-red-600 font-mono">-</span></p>
                        <p><strong>Mediana:</strong> <span id="medianText" class="text-green-600 font-mono">-</span></p>
                        <p class="text-xs text-gray-500 pt-2">Si imputas con la <strong>media</strong> bajo un outlier, estarás introduciendo un sesgo irreal en tus datos ausentes.</p>
                    </div>
                </div>

                <div class="md:col-span-2">
                    <canvas id="imputationChart" height="200"></canvas>
                </div>
            </div>
        </section>

        <!-- Sección 3: Codificación -->
        <section class="bg-indigo-900 text-white p-8 rounded-2xl shadow-xl">
            <div class="flex flex-col md:flex-row gap-8 items-center">
                <div class="flex-1">
                    <h2 class="text-2xl font-bold mb-4">3. De Nominal a Binario (Cap. 3.8)</h2>
                    <p class="text-indigo-200 mb-4 font-light">¿Cómo entiende la máquina el "Tipo de Acero"? Mediante el <strong>One-Hot Encoding</strong>.</p>
                    <div class="grid grid-cols-1 gap-3">
                        <div class="flex items-center gap-3 bg-white/10 p-3 rounded border border-white/20">
                            <span class="bg-indigo-500 px-2 py-1 rounded text-xs">Categoría</span>
                            <span class="font-mono">"Inoxidable"</span>
                            <span class="text-indigo-400">→</span>
                            <span class="font-mono text-yellow-400">[1, 0, 0]</span>
                        </div>
                        <div class="flex items-center gap-3 bg-white/10 p-3 rounded border border-white/20">
                            <span class="bg-indigo-500 px-2 py-1 rounded text-xs">Categoría</span>
                            <span class="font-mono">"Galvanizado"</span>
                            <span class="text-indigo-400">→</span>
                            <span class="font-mono text-yellow-400">[0, 1, 0]</span>
                        </div>
                    </div>
                </div>
                <div class="flex-1 w-full">
                    <p class="text-xs text-indigo-300 mb-2 uppercase font-bold">Código Scikit-Learn:</p>
                    <pre class="bg-black/40 border border-white/10"><code>from sklearn.preprocessing import OneHotEncoder

# Crea el codificador
ohe = OneHotEncoder()
# Transforma la columna 'Material'
X_cat = ohe.fit_transform(df[['Material']])</code></pre>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center py-10 text-gray-400 text-sm">
        <p>Recurso Didáctico - Tema 3: Datos Ausentes y Normalización | UNIR</p>
    </footer>

    <!-- Scripts -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        const ctx = document.getElementById('imputationChart').getContext('2d');
        const slider = document.getElementById('outlierSlider');
        const sliderVal = document.getElementById('sliderVal');
        const meanText = document.getElementById('meanText');
        const medianText = document.getElementById('medianText');

        let data = [45, 48, 52, 49, 51, 50, 47]; // Datos base

        const chart = new Chart(ctx, {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Datos del Sensor',
                    data: data.map((v, i) => ({x: i, y: v})),
                    backgroundColor: '#6366f1',
                }, {
                    label: 'Outlier Ajustable',
                    data: [{x: 7, y: 50}],
                    backgroundColor: '#ef4444',
                    pointStyle: 'rectRot',
                    radius: 8
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { min: 0, max: 210 }
                }
            }
        });

        function updateStats() {
            const outlier = parseInt(slider.value);
            const currentData = [...data, outlier];
            
            // Calcular media
            const mean = currentData.reduce((a, b) => a + b) / currentData.length;
            
            // Calcular mediana
            const sorted = [...currentData].sort((a, b) => a - b);
            const median = sorted[Math.floor(sorted.length / 2)];

            // Actualizar UI
            sliderVal.innerText = outlier;
            meanText.innerText = mean.toFixed(2);
            medianText.innerText = median.toFixed(2);
            
            // Actualizar Chart
            chart.data.datasets[1].data = [{x: 7, y: outlier}];
            chart.update();
        }

        slider.oninput = updateStats;
        updateStats(); // Init
    </script>
</body>
</html>